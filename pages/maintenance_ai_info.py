import streamlit as st
import sys
import os
import pandas as pd

# プロジェクトルートをパスに追加
sys.path.insert(0, os.path.dirname(os.path.dirname(os.path.abspath(__file__))))

from styles import get_custom_css, render_sidebar

st.set_page_config(
    page_title="AI保守基盤レポート | AI Daily News",
    layout="wide",
    initial_sidebar_state="expanded"
)

# カスタムCSS適用
st.markdown(get_custom_css(), unsafe_allow_html=True)

# サイドバーナビゲーション
render_sidebar()

st.markdown("# 市場調査レポート：AIをつかった保守基盤")

st.markdown("---")

# エグゼクティブ・サマリー
st.markdown("## 1. エグゼクティブ・サマリー")
st.markdown("""
AIを活用した保守基盤は、**労働人口減少**と**設備老朽化**を背景に、業務効率化、コスト削減、技術継承の課題解決に不可欠である。報告書自動作成、予知保全、AIテクニカルサポートなど多岐にわたる機能が実装され、大幅な時間・コスト削減効果が報告されている。日立システムズ、NTT DATA、三菱電機などの主要プレイヤーが、生成AIやデジタル基盤を活用したソリューションを提供し、市場を牽引している。
""")

st.markdown("---")

# 主要トレンドと市場背景
st.markdown("## 2. 主要トレンドと市場背景")

with st.expander("👥 労働力不足と技術継承の課題", expanded=True):
    st.markdown("""
    労働人口の低下に伴う業務品質維持の困難化、人手不足、高齢化による技術継承は、保守業界における**喫緊の課題**である。
    
    AIは熟練技術者のノウハウを学習し、若手技術者への技術継承を加速させることで、**属人化の解消**に貢献している。
    """)

with st.expander("🏭 設備老朽化と未然のトラブル防止", expanded=True):
    st.markdown("""
    設備老朽化は業務品質低下や予期せぬ生産ライン停止のリスクを高める。
    
    AIを活用した**予知保全**は、不具合の兆候を事前に検知し、未然にトラブルを防ぐことで、企業の業績へのダメージを回避する。
    """)

with st.expander("🤖 生成AIの活用と業務効率化", expanded=True):
    st.markdown("""
    生成AIは保守業務の効率化を大きく推進している。
    
    **実現されている機能:**
    - 📝 報告書の自動作成
    - 📋 作業手順・危険ポイントを一覧化するチェックシートの自動生成
    - ⚠️ 現地KY（危険予知）の自動化
    - 💬 AIテクニカルサポート
    
    年間130万件に及ぶ現場ナレッジとの組み合わせにより、大幅な時間削減効果を生み出している。
    日立システムズは**1,100時間以上/月**の時間削減効果を見込んでいる。
    """)

with st.expander("💰 オーバーメンテナンスの撲滅とコスト最適化", expanded=True):
    st.markdown("""
    従来の予防保全で発生していた、まだ使用可能な部品の交換（オーバーメンテナンス）は、AIによる予知保全で撲滅されつつある。
    
    **コスト削減効果:**
    - 部品の劣化兆候に基づいた適切な交換タイミング
    - 不要な部品購入費や人件費を削減
    - メンテナンスコスト全体を**18%〜25%削減**した事例も報告
    - 交換部品のジャストインタイム管理による在庫コストの圧縮
    """)

with st.expander("🔧 デジタル基盤による運用・保守の高度化", expanded=True):
    st.markdown("""
    異常診断や予兆検知に留まらず、保全計画全体の立案から保守実行までの業務プロセス全体を横断的に最適化する**デジタルメンテナンスソリューション**が提供されている。
    
    三菱電機の「**Serendie**」のようなデジタル基盤は、稼働状況やアラーム発生の傾向データをAIで分析し、異常発生の兆候を検知・判断することで、停止前のサポートを可能にしている。
    """)

st.markdown("---")

# 主要プレイヤーと動向
st.markdown("## 3. 主要プレイヤーと動向")

players_data = {
    "企業名": [
        "日立システムズ",
        "NTT DATA",
        "三菱電機"
    ],
    "主要ソリューション": [
        "生成AI保守業務支援",
        "デジタルメンテナンスソリューション",
        "Serendie（デジタル基盤）"
    ],
    "最新の取り組み": [
        "2024年10月にIT機器保守業務における報告書自動作成機能を実装。2025年度内にAIテクニカルサポートを実装予定。年間130万件の現場ナレッジと生成AIを組み合わせ、1,100時間以上/月の時間削減効果を見込む。",
        "設備保全や保守業務を高度化するサービス群を提供。異常診断や予兆検知に加え、保全計画立案から保守実行までの業務プロセス全体を横断的に最適化。",
        "2024年10月からワイヤ放電加工機の「見守りサービス」を開始。AIが蓄積データに基づき異常発生の兆候を検知・判断。MELSOFT MaiLabにより保守作業工数を67%削減に成功。"
    ]
}

df_players = pd.DataFrame(players_data)
st.dataframe(df_players, use_container_width=True, hide_index=True)

st.markdown("---")

# 戦略的インサイト
st.markdown("## 4. 戦略的インサイト")

st.info("💡 AIを活用した保守基盤は、単なる業務効率化ツールを超え、**企業競争力強化のための戦略的柱**であると認識すべきである。")

col1, col2, col3 = st.columns(3)

with col1:
    st.markdown("### 🎯 技術継承支援")
    st.markdown("""
    労働力不足と技術継承の深刻化を鑑みると、生成AIによるナレッジ活用と技術継承支援は、企業の持続可能性を担保する上で**不可欠な投資**である。
    
    熟練技術者の暗黙知をデータ化し、AIが若手技術者の判断を支援することで、組織全体の技術レベルを底上げし、属人化を解消できる。
    """)

with col2:
    st.markdown("### 💰 コスト削減効果")
    st.markdown("""
    予知保全の導入は、オーバーメンテナンスを撲滅し、部品購入費や人件費の**大幅な削減**に直結する。
    
    同時に、予期せぬ設備停止を回避することで、生産性向上と顧客満足度向上に貢献。短期的にはコスト削減、長期的にはレジリエントなサプライチェーン構築に繋がる。
    """)

with col3:
    st.markdown("### 🌐 エコシステム最適化")
    st.markdown("""
    デジタル基盤を通じたデータの一元管理とAI分析は、自社製品に留まらず、他社製品を含む**設備全体のエコシステム最適化**を可能にする。
    
    これにより、新たなサービスモデルの創出や、顧客への付加価値提供の機会が生まれる。
    """)

st.markdown("---")

# 導入への提言
st.markdown("## 5. 導入への提言")

st.warning("""
**企業への推奨アクション:**

1. 自社の保守業務における具体的な課題を特定する
2. 報告書自動作成や簡易的な予知保全から段階的にAIソリューションを導入
3. 実績を積みながら適用範囲を広げる

**成功の鍵:**
既存の運用データや熟練技術者の知見をAIに学習させるための**データ収集・整備体制の構築**にあり、これには経営層の強力なコミットメントが求められる。
""")

st.markdown("---")

# フッター
st.markdown(
    """
    <div style="text-align: center; color: #999; padding: 1rem 0;">
        <p>AI Daily News | 市場調査レポートシリーズ</p>
    </div>
    """,
    unsafe_allow_html=True
)
